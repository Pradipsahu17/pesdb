<%@ Page Title="" Language="C#" MasterPageFile="~/EverestMaster.Master" AutoEventWireup="true" CodeBehind="LoanApplication.aspx.cs" Inherits="Everest.Net.Web.Report.Loan.LoanApplication" %>

<%@ Register Src="~/UserControls/TimeUserControl.ascx" TagPrefix="ucEverest" TagName="TimeUserControl" %>
<%@ Register Src="~/UserControls/Customer.ascx" TagPrefix="Everest" TagName="Customer" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TopScriptContentPlaceholder" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="PageTitleContentPlaceHolder" runat="server">
    <span><i class="fa fa-archive">&nbsp; Loan Application Request</i></span>
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="FormContentPlaceholder" runat="server">
    <div class="row" id="MainPageContent">
        <div class="col-sm-12">
            <div class="box box-primary">
                <div class="box-body">
                    <%--Toolbar Box Start--%>
                    <div id="ToolBarDiv" class="row" runat="server">
                        <div class="col-sm-9">

                            <asp:ScriptManager runat="server"></asp:ScriptManager>
                            <asp:UpdatePanel ID="update" runat="server">
                                <ContentTemplate>
                                    <asp:LinkButton ID="AddNewButton" runat="server"
                                        CssClass="btn btn-default btn-sm" CausesValidation="false">
                                    <i class='glyphicon glyphicon-plus'></i>&nbsp;Add New
                                    </asp:LinkButton>
                                    <asp:LinkButton ID="EditButton" runat="server"
                                        CssClass="btn btn-default btn-sm" CausesValidation="false"
                                        OnClick="EditButton_Click">
                                    <i class='glyphicon glyphicon-pencil'></i>&nbsp;Edit
                                    </asp:LinkButton>
                                    <asp:LinkButton ID="DeleteButton" runat="server"
                                        CssClass="btn btn-danger btn-sm" CausesValidation="false"
                                        OnClick="DeleteButton_OnClick">
                                    <i class='glyphicon glyphicon-trash'></i>&nbsp;Delete
                                    </asp:LinkButton>
                                    <asp:LinkButton ID="RefreshButton" runat="server"
                                        CssClass="btn btn-success btn-sm" CausesValidation="false"
                                        OnClick="RefreshButton_OnClick">
                                    <i class='glyphicon glyphicon-refresh'></i>&nbsp;Refresh
                                    </asp:LinkButton>
                                    <asp:LinkButton ID="ReportButton" runat="server"
                                        CssClass="btn btn-info btn-sm" CausesValidation="false"
                                        OnClick="PrintButton_OnClick">
                                    <i class='glyphicon glyphicon-file'></i>&nbsp;Show Report
                                    </asp:LinkButton>
                                </ContentTemplate>
                            </asp:UpdatePanel>

                        </div>
                        <div class="col-sm-3">
                            <div class="input-group">
                                <asp:TextBox ID="SearchTextBox" runat="server"
                                    CssClass="form-control input-sm" placeholder="Search..." />
                                <span class="input-group-addon"><i class="" runat="server"></i>
                                    <asp:LinkButton ID="SearchButton" runat="server"
                                        CausesValidation="false"
                                        ToolTip="Search">
                                    <i class='fa fa-search'></i>
                                    </asp:LinkButton>
                                </span>
                            </div>
                        </div>
                    </div>
                    <%--Toolbar Box End--%>


                    <div id="GridDiv" runat="server" style="overflow: auto;" class="table-responsive">
                        <br />
                        <asp:GridView runat="server" ID="LoanApplicationGridView" EmptyDataText="No data available"
                            CssClass="table table-hover selectable" AutoGenerateColumns="False"
                            HeaderStyle-CssClass="success" Font-Size="Small"
                            GridLines="None" RowStyle-Height="1">
                            <Columns>
                                <asp:TemplateField HeaderText="Select">
                                    <ItemTemplate>
                                        <asp:RadioButton runat="server" CssClass="RadioButtons" ID="SelectRadio" />
                                    </ItemTemplate>
                                </asp:TemplateField>
                                <asp:BoundField DataField="ApplicationId" HeaderText="Application Id" />
                                <asp:BoundField DataField="OfficeId" HeaderText="Office Id" />
                                <asp:BoundField DataField="CustomerName" HeaderText="Customer Name" />
                                <asp:BoundField DataField="LoanProductName" HeaderText="Loan Product Name" />
                                <asp:BoundField DataField="ApplicationDate" HeaderText="Application Date" DataFormatString="{0:yyyy/MM/dd}" />
                                <asp:HyperLinkField Text="GetDetails" DataNavigateUrlFields="ApplicationId" DataNavigateUrlFormatString="LoanApplicationChat.aspx?ApplicationId={0}" />
                                <asp:TemplateField HeaderText="Action">
                                    <ItemTemplate>
                                        <asp:UpdatePanel ID="UpdatePanel2" runat="server">
                                            <ContentTemplate>
                                                <asp:LinkButton CssClass="btn btn-default btn-sm"  CommandArguement='<%# Eval("ApplicationId") %>' id="UploadButton" runat="server" ><i class='glyphicon glyphicon-arrow-up'></i></asp:LinkButton>
                                                <asp:LinkButton CssClass="btn btn-default " runat="server">Upload Image</asp:LinkButton>
                                                <asp:LinkButton CssClass="btn btn-default btn-sm" ID="ChatButton" runat="server">C</asp:LinkButton>
                                            </ContentTemplate>
                                        </asp:UpdatePanel>
                                    </ItemTemplate>
                                </asp:TemplateField>
                            </Columns>
                        </asp:GridView>
                        <br />
                        <Everest:EverestPager runat="server" ID="Pager"></Everest:EverestPager>

                    </div>


                    <div id="FormDiv" runat="server" class="form-horizontal" style="display: none;">
                        <asp:HiddenField ID="IsEditHiddenField" runat="server" />
                        <asp:HiddenField ID="SelectedIdHiddenField" runat="server" />

                        <div style="border-bottom: 1px solid #d2d6de; margin-bottom: 20px;">
                            <h3>Customer Details</h3>
                            <div class="form-group">
                                <label class="control-label col-sm-2">
                                    Application Date*
                                </label>
                                <div class="col-sm-3 " style="margin-left: -9px;">
                                    <Everest:DateControl runat="server" ID="DateControlFrom" />
                                </div>
                            </div>
                            <div class="form-group">
                                <Everest:Customer runat="server" ID="CustomerUc" />
                            </div>
                        </div>

                        <asp:UpdatePanel ID="UpdatePanel1" runat="server">
                            <ContentTemplate>
                                <div class="form-group" id="HandelCorporate" visible="false" runat="server">
                                    <label class="control-label col-sm-2">
                                        OfficeName*
                                    </label>
                                    <div class="col-sm-3">
                                        <asp:DropDownList ID="OfficeDropDownList" OnSelectedIndexChanged="OfficeDropDownList_SelectedIndexChanged" AutoPostBack="true" runat="server" CssClass="form-control input-sm" />
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-2">
                                        CollectorName*
                                    </label>
                                    <div class="col-sm-3">
                                        <asp:DropDownList ID="CollectorDropDownList" runat="server" CssClass="form-control input-sm" />
                                    </div>
                                </div>
                            </ContentTemplate>
                        </asp:UpdatePanel>
                        <div class="form-group">
<%--                            <label class="control-label col-sm-2">
                                UserName*
                            </label>
                            <div class="col-sm-3">
                                <asp:DropDownList ID="UserDropDownList" runat="server" CssClass="form-control input-sm" />
                            </div>--%>
                            <label class="control-label col-sm-2">
                                LoanProductName*
                            </label>
                            <div class="col-sm-3">
                                <asp:DropDownList ID="LoanProductNameDropDownList" runat="server" CssClass="form-control input-sm" />
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="control-label col-sm-2">
                                LoanDemandAmount*
                            </label>
                            <div class="col-sm-3">
                                <asp:TextBox ID="LoanDemandAmountTextBox" runat="server" CssClass="form-control input-sm"></asp:TextBox>
                            </div>
                            <label class="control-label col-sm-2">
                                ApprovedAmount*
                            </label>
                            <div class="col-sm-3">
                                <asp:TextBox ID="ApprovedAmountTextBox" runat="server" CssClass="form-control input-sm"></asp:TextBox>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-sm-2">
                                Notes*
                            </label>
                            <div class="col-sm-3">
                                <asp:TextBox ID="NotesTextBox" TextMode="MultiLine" Rows="5" Columns="10" runat="server" CssClass="form-control input-sm"></asp:TextBox>
                            </div>
                        </div>
                        <div class="col-sm-offset-2">
                            <asp:LinkButton ID="SaveButton" runat="server"
                                CssClass="btn btn-primary btn-sm" OnClick="SaveButton_Click">
                                    <i class='glyphicon glyphicon-floppy-disk'></i>&nbsp;Save
                            </asp:LinkButton>
                            <asp:LinkButton ID="CancelButton" runat="server"
                                CssClass="btn btn-default btn-sm" CausesValidation="false"
                                PostBackUrl="~/Setup/Office/FiscalYearSetup.aspx">
                                    <i class='glyphicon glyphicon-remove-circle'></i>&nbsp;Cancel
                            </asp:LinkButton>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</asp:Content>
<asp:Content ID="Content4" ContentPlaceHolderID="BottomScriptContentPlaceholder" runat="server">
    <link href="../Scripts/bootstrap-timepicker-gh-pages/css/bootstrap-timepicker.css" rel="stylesheet" />
    <script src="../Scripts/bootstrap-timepicker-gh-pages/js/bootstrap-timepicker.js"></script>
    <script type="text/javascript">
        //#region keydown functions
        $(window).keydown(function (e) {
            //Press Esc Key || Space
            if (e.keyCode == 27 || e.keyCode == 32) {
                $('#MaskOverlay, #MaskLoading').hide();
            }
        });
        //#endregion
        $('#AddNewButton').click(function (evt) {
            $('#NotificationDiv').hide();
            evt.preventDefault();
            resetAllInputs();
            $('#ToolBarDiv,#FormDiv,#GridDiv').toggle(300);
        });
        $('#EditButton').click(function (evt) {
            evt.preventDefault();
            if ($('.RadioButtons input:radio').is(':checked')) {
                bootbox.confirm("Are you sure to edit?", function (result) {
                    if (result == false) {
                        evt.preventDefault();
                    }
                    else {

                        $('#GridDiv,#ToolBarDiv,#FormDiv').toggle(300);
                        __doPostBack("<%= EditButton.UniqueID %>", "");
                    }
                });
            } else {
                bootbox.alert("Nothing is selected!");
                evt.preventDefault();
            }
        });
        $("#DeleteButton").click(function (evt) {
            evt.preventDefault();
            if ($('.RadioButtons input:radio').is(':checked')) {
                bootbox.confirm("Are you sure to delete?", function (result) {
                    if (result == false) {
                        evt.preventDefault();
                    } else {
                        __doPostBack("<%= DeleteButton.UniqueID %>", "");
                    }
                });
            } else {
                bootbox.alert("Nothing is selected!");
                evt.preventDefault();
            }
        });


        $("#ReportButton").live('click', function (evt) {
            $.showprogress('<b> Please wait while loading report... </b>');

            $.colorbox({
                iframe: true,
                innerWidth: "90%",
                innerHeight: "90%",
                href: baseURL() + "/Report/ReportMaster.aspx",
                onCleanup: function () {
                }
            });
        });
        $("#UploadButton").live('click', function (e) {

            e.preventDefault();

            var applicationID = 0;

            $.colorbox({
                iframe: true,
                innerWidth: "90%",
                innerHeight: "90%",
                href: baseURL() + "/Report/Loan/LoanApplicationUploadImage.aspx",
                onCleanup: function () {
                }
            });
        });
        $("#ChatButton").live('click', function (e) {

            e.preventDefault();
            $.colorbox({
                iframe: true,
                innerWidth: "90%",
                innerHeight: "90%",
                href: baseURL() + "/Report/Loan/LoanApplicationChat.aspx",
                onCleanup: function () {
                }
            });
        });
        $('#CloseButton').click(function () {
            $('#MaskOverlay, #MaskLoading').hide();
        });
        $('#CancelButton').click(function (evt) {
            evt.preventDefault();
            resetAllInputs();
            $('#ToolBarDiv,#FormDiv,#GridDiv').toggle(300);
        });

    </script>
</asp:Content>
